clc;clear;

w1=[-0.4,0.58,0.089;
    -0.31,0.27,-0.04;
    -0.38,0.055,-0.035;
    -0.15,0.53,0.011;
    -0.35,0.47,0.034;
    -0.17,0.69,0.1;
    -0.011,0.55,-0.18;
    -0.27,0.61,0.12;
    -0.065,0.49,0.0012;
    -0.12,0.054,-0.063];
w2=[0.8,1.6,-0.014;
    1.1,1.6,0.48;
    -0.44,-0.41,0.32;
    0.047,-0.45,1.4;
    0.28,0.35,3.1;
    -0.39,-0.48,0.11;
    0.34,-0.079,0.14;
    -0.3,-0.22,2.2;
    1.1,1.2,-0.46;
    0.18,0.11,-0.49];
w3=[1.58,2.32,-5.8;
    0.67,1.58,-4.78;
    1.04,1.01,-3.63;
    -1.49,2.18,-3.39;
    -0.41,1.21,-4.73;
    1.39,3.61,2.87;
    1.2,1.4,-1.89;
    -0.92,1.44,-3.22;
    0.45,1.33,-4.38;
    -0.76,0.84,-1.96];
test1=[-0.7,0.58,0.089]';test2=[0.047,-0.4,1.04]';

s1=cov(w2,1);m1=mean(w2)';
s2=cov(w3,1);m2=mean(w3)';
sw=s1+s2;w=(sw) \ (m1-m2);
y0=(w'*m1 + w'*m2)/2;%判别函数及阈值y_0,阈值取两类心投影连线的中点

figure('Name','Before');hold on;view(3);
xlabel('X');ylabel('Y');zlabel('Z');title('分类前');
plot3(w2(:,1),w2(:,2),w2(:,3),'r*');
plot3(w3(:,1),w3(:,2),w3(:,3),'bo');

figure('Name','After');hold on;
z1=w'*w2';z2=w'*w3';
xmin=min(min(w2(:,1),min(w3(:,2))));
xmax=max(max(w2(:,1),max(w3(:,2))));
t=linspace(xmin-1,xmax);
plot3(30*t,30*t*w(2)/w(1),30*t*w(3)/w(1),'k');
plot3(z1*w(1),z1*w(2),z1*w(3),'rx');
plot3(z2*w(1),z2*w(2),z2*w(3),'bp');
xlabel('X');ylabel('Y');zlabel('Z');title('分类后');
axis([-8.6,5.3,-5.2,29.9,-9.83,3.34]);
view([105.25,-36.98])